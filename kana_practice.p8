pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- kana practice
-- by sestren
-- github.com/sestrenexsis/kanapractice

-- based on shodo
-- by ryosuke mihara
-- github.com/oinariman/shodo

-- description:
-- * ink drying

-- modes:
-- * guided learning
-- * quiz

-- quiz mode:
-- * choose a random kana
-- * ask the player to draw it
-- * stroke order matters
-->8
-- px   : x position
-- py   : y position
-- vx   : x velocity
-- vy   : y velocity
-- lx   : last x pos
-- ly   : last y pos
-- sz   : brush radius
-- on   : using brush

-- accl : speedup when moving
-- drag : slowdown over time
_accl=0.175
_drag=0.1

function _init()
	cls()
	sspr(0,0,128,128,0,0)
	_brush_px=64
	_brush_py=64
	_brush_vx=0
	_brush_vy=0
	_brush_lx=64
	_brush_ly=64
	_brush_sz=0
	_brush_on=false
	_ink={}
end

function _update()
	_brush_on=btn(❎)
	if (btn(⬆️)) _brush_vy-=_accl
	if (btn(⬇️)) _brush_vy+=_accl
	if (btn(⬅️)) _brush_vx-=_accl
	if (btn(➡️)) _brush_vx+=_accl
	if _brush_vx>0 then
		_brush_vx-=_drag
		_brush_vx=max(0,_brush_vx)
	else
		_brush_vx+=_drag
		_brush_vx=min(0,_brush_vx)
	end
	if _brush_vy>0 then
		_brush_vy-=_drag
		_brush_vy=max(0,_brush_vy)
	else
		_brush_vy+=_drag
		_brush_vy=min(0,_brush_vy)
	end
	if (_brush_vx~=0) then
		_brush_px+=_brush_vx
	end
	if (_brush_vy~=0) then
		_brush_py+=_brush_vy
	end
	if _brush_on then
		id=128*flr(_brush_py)
		id+=flr(_brush_px)
		if (_ink[id]==nil) _ink[id]=2
		_ink[id]=max(_ink[id],2)
	end
end

function _draw()
	cls()
	sspr(0,0,128,128,0,0)
	for id,r in pairs(_ink) do
		px=id%128
		py=flr(id/128)%128
		circfill(px,py,r,1)
	end
	circfill(_brush_px,_brush_py,1,7)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000001110000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000001110000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000001110000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000008880000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888800000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888800000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888800000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888800000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888800000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888000000000000002222000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888000000000000222222200000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000888888000000000022222222220000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000888880000000022222222222220000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000888880000022222222222222200000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000888832222222222222222220000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000333332222222222222220000000000000000000000000000000000000000000000000000
00000000000000000000000000000010000000000000000000002222333332222222222220000000000000000000000000000000000000000000000000000000
00000000000000000000000000000010000000000000000022222222333332222222000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000010000022222222222222222223333322220000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000010000022222222222222222223338800000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000010000002222222222222222008888800000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000222222222220000008888800000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000222000000000008888800000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000008888800000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000008888800000000000000000011100000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000008888800000000000000000000100000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000008888000000000000000000001100000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000008888000000000000e00000000100000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000088888000000000000eee000011100000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000088888000000000000eeee00000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000008888800000000000eeeee00000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000008888800000000000eeeeee0000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000008888800000000000eeeeee0000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000888880000000000eeeeee00000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000888880000000000eeeeeeeeeeeee0000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000888800000000eeeeeeeeeeeeeeeeeee0000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000888800000eeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000088880eeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000008833eeeeeeeeeeeeeee0000000eeeeeeeeeee0000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000003333eeeeee000eeeeee00000000000eeeeeeee000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000033333eeee0000eeeeee00000000000000eeeeeee00000000000000000000000000000000000
000000000000000000000000000000000000000000000000000ee33333e0000000eeeeee000000000000000eeeeeee0000000000000000000000000000000000
0000000000000000000000000000000000000000000000000eeee333380000000eeeeee00000000000000000eeeeeee000000000000000000000000000000000
000000000000000000000000000000000000000000000000eeeee338880000000eeeee0000000000000000000eeeeee000000000000000000000000000000000
0000000000000000000000000000000000000000000000eeeeeee88888000000eeeeee00000000000000000000eeeeee00000000000000000000000000000000
00000000000000000000000000000000000000000000eeeeeeee088888000000eeeee0000000000000000000000eeeee00000000000000000000000000000000
0000000000000000000000000000000000000000000eeeeeee0008888800000eeeeee0000000000000000000000eeeeee0000000000000000000000000000000
000000000000000000000000000000000000000000eeeeeee00008888800000eeeee00000000000000000000000eeeeee0000000000000000000000000000000
00000000000000000000000000000000000000000eeeeee000000888880000eeeeee000000000000000000000000eeeee0000000000000000000000000000000
000000000000000000000000000000000000000eeeeee0000000088888000eeeeee0000000000000000000000000eeeeee000000000000000000000000000000
00000000000000000000000000000000000000eeeeee00000000088888000eeeee00000000000000000000000000eeeeee000000000000000000000000000000
0000000000000000000000000000000000000eeeeee00000000008888800eeeee000000000000000000000000000eeeeee000000000000000000000000000000
000000000000000000000000000000000000eeeeee00000000000888880eeeeee000000000000000000000000000eeeeee000000000000000000000000000000
00000000000000000000000000000000000eeeeee00000000000088888eeeeee0000000000000000000000000000eeeeee000000000000000000000000000000
0000000000000000000000000000000000eeeeee000000000000088883eeeee00000000000000000000000000000eeeeee000000000000000000000000000000
000000000000000000000000000000000eeeeee0000000000000088883eeee000000000000000000000000000000eeeeee000000000000000000000000000000
000000000000000000000000000000000eeeee00000000000000088833eeee000000000000000000000000000000eeeeee000000000000000000000000000000
00000000000000000000000000000000eeeeee00000000000000088333eee0000000000000000000000000000000eeeee0000000000000000000000000000000
00000000000000000000000000000000eeeee000000000000000083333ee0000000000000000000000000000000eeeeee0000000000000000000000000000000
00000000000000000000000000000000eeeee000000000000000033333300000000000000000000000000000000eeeeee0000000000000000000000000000000
00000000000000000000000000000000eeeee000000000000000e3333380000000000000000000000000000000eeeeee00000000000000000000000000000000
00000000000000000000000000000000eeeee00000000000000ee3333880000000000000000000000000000000eeeeee00000000000000000000000000000000
00000000000000000000000000000000eeeee000000000000eeeee33888000000000000000000000000000000eeeeee000000000000000000000000000000000
000000000000000000000000000000000eeee00000000000eeeeee38888800000000000000000000000000000eeeee0000000000000000000000000000000000
000000000000000000000000000000000eeeee00000000eeeeeeee8888880000000000000000000000000000eeeeee0000000000000000000000000000000000
000000000000000000000000000000000eeeee000000eeeeeeee00888888000000000000000000000000000eeeeee00000000000000000000000000000000000
0000000000000000000000000000000000eeeeeeeeeeeeeeeee00088888800000000000000000000000000eeeeee000000000000000000000000000000000000
0000000000000000000000000000000000eeeeeeeeeeeeeee000008888880000000000000000000000000eeeeee0000000000000000000000000000000000000
0000000000000000000000000000000000eeeeeeeeeeeeee000000088888000000000000000000000000eeeee000000000000000000000000000000000000000
00000000000000000000000000000000000eeeeeeeeeee000000000888880000000000000000000000eeeeee0000000000000000000000000000000000000000
000000000000000000000000000000000000eeeeeeee0000000000088888000000000000000000000eeeee000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000008880000000000000000000eeeee00000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000eeeee0000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000eee0000000000000000000000000000000000000000000000000
